
# postgres
database_postgres_workdir: "{{ app_base_dir }}/database/postgres"
database_postgres_datadir: "{{ database_postgres_workdir }}/postgres-data"
database_postgres_scope: postgres_cluster
database_postgres_port: 8432
database_patroni_restapi_port: 8008
database_postgres_user:
  superuser:
    username: "postgres"
    password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33306131366665346136346466363766336336346665363061623530376565316365666333623566
          6339316535343732333635313464386162373564323537300a336638663139613961636462333561
          33323664323039613838626665353338643434613464336464376335356336396134636264393438
          6334343662376230360a626631663764633466313730376235666438613832393665623862643339
          36323735343630316436376639383662613033643364393463636236383730613330
  replication:
    username: "replicator"
    password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          38366638343732626335643365396632326664396564336339343933393365653631393839373437
          6235613466623433336131353730653266346263333237380a386166656638336430363061616130
          34376436323637346539653739393233613636333164633130623664613361626532646139663630
          3862323333323735310a643764386661373431666633366530636236346366303137346130646662
          61396461613162393837663739623265353564396165663338313934366636613366
  rewind:
    username: "rewind"
    password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          37346631356163313236373364623865393861363330623739613935306235653466636534313331
          6233663837666135663637326433396634663664303364330a323730306662386661336632356434
          62313637653265333439323035376362656566323631636437336537343835663239383365656139
          3265666363306639320a356562663066303734656163306165363733383662313064393737643966
          3434

database_postgres_image: nguyenhiep201/postgres-13.6-patroni-3.1.0:1.0.0
# database_postgres_image: lechiennn/patroni-v3.3.1-timescaledb:latest-pg13
# database_postgres_image: lechiennn/patroni-v3.1.0-postgres:11-bullseye
database_postgres_exporter_image: prometheuscommunity/postgres-exporter
database_postgres_exporter_port: 9187

# consul
database_consul_image: hashicorp/consul:1.19.0
database_consul_workdir: "{{ app_base_dir }}/database/consul"
database_consul_datadir: "{{ database_consul_workdir }}/data"

# etcd
database_etcd_workdir: "{{ app_base_dir }}/database/etcd"
database_etcd_image: bitnami/etcd:3.5.15
database_etcd_listen_peer_port: 2380
database_etcd_listen_client_port: 2379
database_etcd_allow_none_authentication: yes
database_etcd_listen_peer_urls: http://0.0.0.0:{{ database_etcd_listen_peer_port }}
database_etcd_listen_client_urls: http://0.0.0.0:{{ database_etcd_listen_client_port }}
database_etcd_initial_advertise_peer_urls: http://{{ ansible_host }}:{{ database_etcd_listen_peer_port }}
database_etcd_advertise_client_urls: http://{{ ansible_host }}:{{ database_etcd_listen_client_port }}
database_etcd_initial_cluster_token: database-etcd
database_etcd_initial_cluster_state: new
database_etcd_enable_v2: true
database_etcd_data_dir: /etcd-data

# pgbouncer
database_pgbouncer_workdir: "{{ app_base_dir }}/database/pgbouncer"
database_pgbouncer_port: 6432
database_pgbouncer_image: brainsam/pgbouncer:latest
database_pgbouncer_auth_type: "md5"
database_pgbouncer_auth_file: "/pgbouncer/users.txt"
database_pgbouncer_exporter_image: spreaker/prometheus-pgbouncer-exporter:latest
database_pgbouncer_exporter_port: 9127
database_pgbouncer_pool_mode: "transaction"
database_pgbouncer_max_client_conn: 1000
database_pgbouncer_listen_addr: "0.0.0.0"
database_pgbouncer_admin_users: "postgres"
database_pgbouncer_default_pool_size: 30
database_pgbouncer_postgres_pools:
  - name: "postgres"
    dbname: "postgres"
    password_md5: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          32653463303239343264343734333336613938626438613163633861396235343435613265643235
          3263646538653665353833353633663837376637366261330a663037333334396161386166336537
          30313766313039346632633834663437383033396362326133303963336263353934353661656361
          3332643134623661310a393437313736306538666432633534363536616130623866326138626237
          64333937663263393666666436626533613866363737616434653834383638326164376232316330
          3961393439623935343234656137363164666136336163666365
database_pgbouncer_exporter_include_databases:
  - name: postgres

# haproxy
database_haproxy_workdir: "{{ app_base_dir }}/database/haproxy"
database_haproxy_image: haproxy:2.0.7
database_haproxy_exporter_image: prom/haproxy-exporter
database_haproxy_listen_port:
  stats: 9000
  postgres: 5432
  pgbouncer: 5433
database_haproxy_exporter_port: 9101


# keepalived
# database_keepalived_image: keepalived:2.0.20
# https://github.com/osixia/docker-keepalived
database_keepalived_image: osixia/keepalived:stable
database_keepalived_workdir: "{{ app_base_dir }}/database/keepalived"
database_keepalived_vip_address: 100.99.98.97

# database_confd_image: dcim-confd:1.0
# database_confd_image: dockage/confd:alpine3.6
database_confd_image: lechiennn/confd:1.0